{% extends "base.html" %}

{% block title %}Tickets for {{ repo.name }}{% endblock %}

{% block extra_head %}
    <script type="text/javascript" src="{{ MEDIA_URL }}media/js/jquery-1.3.2.js"></script>
    <script type="text/javascript">
        $(function() {
            $('#create_report').click(function() {
                var name = prompt("What should this report be named?", "");
                if (name == null) {
                    return;
                }
                $('#report_name').val(name);
                $('#report_form').submit()
            });
        })
    </script>
{% endblock %}

{% block page_title %}Tickets{% endblock %}

{% block content %}
    <div class="box">
        <fieldset>
            <legend>Custom Query</legend>
            <form action="" method="get">
                <table>
                    {% for field in filter.form %}
                        <tr>
                            <th>{{ field.label_tag }}</th>
                            <td>{{ field }}</td>
                        </tr>
                    {% endfor %}
                    <tr>
                        <td></td>
                        <td><input type="submit" />
                    </tr>
                </table>
            </form>
        </fieldset>
    </div>
    <table>
        <tr>
            <th>#</th>
            <th>Creator</th>
            <th>Created At</th>
            <th>Title</th>
        </tr>
        {% for ticket in filter.qs %}
            <tr>
                <td>
                    <a href="{{ ticket.get_absolute_url }}">{{ ticket.id }}</a>
                </td>
                <td>
                    {{ ticket.creator }}
                </td>
                <td>
                    {{ ticket.created_at }}
                </td>
                <td>
                    {{ ticket.title }}
                </td>
            <tr>
        {% endfor %}
    </table>
    <div class="box">
        <div class="prefix_14">
            <form id="report_form" action="" method="post">
                <input id="report_name" name="report_name" type="hidden" />
                <input id="create_report" type="button" value="Create report" />
            </form>
        </div>
    </div>
{% endblock %}
