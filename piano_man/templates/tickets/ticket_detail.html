{% extends "base.html" %}

{% block title %}Details for ticket #{{ ticket.pk }} on {{ repo.name }}{% endblock %}

{% block content %}
    <h1>{{ ticket.title }}</h1>
    <ul>
        <li>Created by: {{ ticket.creator }}</li>
        <li>Created at: {{ ticket.created_at }}</li>
        {% for selection in ticket.selections.all %}
            <li>{{ selection.option }}: {{ selection.choice.text }}</li>
        {% endfor %}
    </ul>

    <h3>Changes</h3>
    <ul>
        {% for change in ticket.changes.all %}
            <li>
                <ul>
                    {% for change_item in change.changes.all %}
                        <li>
                            {{ change_item.option }} changed from {% if change_item.from_text %}{{ change_item.from_text }}{% else %}empty{% endif %} to {{ change_item.to_text }}
                        </li>
                    {% endfor %}
                </ul>
                <p>Changed by {{ change.user}} at {{ change.at }}</p>
                <p>{{ change.text }}</p>
            </li>
        {% endfor %}
    </ul>
    <table>
        <form method="post" action=".">
            {{ form }}
            {{ detail_form }}
            <tr>
                <td></td>
                <td><input type="submit" /></td>
            </tr>
        </form>
    </table>
{% endblock %}
